// Generated by CoffeeScript 1.3.3
(function() {
  var Items, itemMapping, reset_data, viewModel;

  Items = new Meteor.Collection('items');

  reset_data = function() {
    var curItem;
    Items.remove({});
    curItem = Items.insert({
      item: 'First Item',
      indent: 0
    });
    curItem = Items.insert({
      item: 'Second Item',
      indent: 0
    });
  };

  if (Meteor.is_client) {
    itemMapping = {
      item: {
        create: function(options) {
          var observable, parent;
          parent = options.parent;
          observable = ko.observable(options.data);
          parent.isEditing = ko.observable(false);
          parent.modeTemplate = function() {
            if (parent.isEditing()) {
              return 'itemEditing';
            } else {
              return 'item';
            }
          };
          parent.setEditing = function() {
            return parent.isEditing(true);
          };
          parent.clearEditing = function() {
            return parent.isEditing(false);
          };
          return observable;
        }
      }
    };
    viewModel = {
      items: ko.meteor.find(Items, {}, {}, itemMapping),
      resetData: function() {
        return reset_data;
      }
    };
    Meteor.startup(function() {
      return ko.applyBindings(viewModel);
    });
  }

  if (Meteor.is_server) {
    Meteor.startup(function() {
      if (Items.find().count() === 0) {
        return reset_data();
      }
    });
  }

}).call(this);
